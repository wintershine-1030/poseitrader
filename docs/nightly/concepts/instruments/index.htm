<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-nightly docs-doc-page docs-doc-id-concepts/instruments" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Instruments | PoseiTrader Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="docs/latestimg/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="docs/latestimg/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="docs/latestnightly/concepts/instruments"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="Open-source trading platform, Algorithmic trading software, Event-driven backtesting, Live trading with no code changes, Trade any asset class, Low-latency trading execution, Python API for trading strategies, Custom market data integration, Futures and options trading, Crypto spot and derivatives trading, Equities trading simulation, FX spot trading, Sports betting markets trading, Fast backtesting strategies, Advanced trading orders, Rust-based trading platform, High-performance trading system, Nanosecond resolution market simulation, Trading across multiple venues, Trading platform for hedge funds, Seamless data integration, Customizable trading strategies, AI and ML trading strategies, Posei trading platform, Multi-venue trading, Unlimited backtesting strategies, Fast trading execution solutions, Realistic market simulations, Seamless trading API integration, PoseiTrader Documentation, Docs, PoseiTrader Docs"><meta data-rh="true" name="title" content="PoseiTrader Documentation"><meta data-rh="true" name="og:title" content="PoseiTrader Documentation"><meta data-rh="true" name="og:description" content="PoseiTrader is a high-performance platform for automating trading strategies, built on the powerful Posei framework for backtesting and real-time trading."><meta data-rh="true" name="og:image" content="img/preview.png"><meta data-rh="true" name="og:url" content="/docs/latest"><meta data-rh="true" name="docusaurus_version" content="nightly"><meta data-rh="true" name="docusaurus_tag" content="docs-default-nightly"><meta data-rh="true" name="docsearch:version" content="nightly"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-nightly"><meta data-rh="true" property="og:title" content="Instruments | PoseiTrader Documentation"><meta data-rh="true" name="description" content="The Instrument base class represents the core specification for any tradable asset/contract. There are"><meta data-rh="true" property="og:description" content="The Instrument base class represents the core specification for any tradable asset/contract. There are"><link data-rh="true" rel="icon" href="../../../img/shell.ico"><link data-rh="true" rel="canonical" href="index.htm"><link data-rh="true" rel="alternate" href="index.htm" hreflang="en"><link data-rh="true" rel="alternate" href="index.htm" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://CWRKEEL01M-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Concepts","item":"docs/latestnightly/concepts/"},{"@type":"ListItem","position":2,"name":"Instruments","item":"docs/latestnightly/concepts/instruments"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="PoseiTrader Documentation" href="../../../opensearch.xml">
<script>!function(){var t=window.location.pathname;if(t.startsWith("/docs")&&!t.startsWith("/docs/latest")&&!t.startsWith("/docs/nightly")){var s=t.replace("/docs","/docs/latest");window.location.href=s}}()</script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TR4XK597XK"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-TR4XK597XK",{anonymize_ip:!0})</script><link rel="stylesheet" href="../../../assets/css/styles.0f0f692e.css">
<script src="../../../assets/js/runtime~main.92b727d5.js" defer="defer"></script>
<script src="../../../assets/js/main.1cd42d85.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewbox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewbox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="../../../../index.htm" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="../../../img/nt-black-large.webp" alt="PoseiTrader Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="../../../img/nt-white-large.webp" alt="PoseiTrader Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Version</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="../../../latest/index.html">latest</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="../../index.htm">nightly</a></li></ul></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewbox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/poseisysstems" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link common-social" aria-label="GitHub repository"></a> <a href="https://twitter.com/PoseiTrader" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-x-link common-social" aria-label="X"></a><div class="toggleContainer_T22x colorModeToggle_DEke"><button class="clean-btn toggleButton_yw5v toggleButtonDisabled_BJd7" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><div class="switch_Ms1n"><span class="iconWrapper_FHql"><style data-emotion="css lp52so">.css-lp52so{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;color:black;font-size:14px;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium lightToggleIcon_SFTY css-lp52so" focusable="false" aria-hidden="true" viewbox="0 0 24 24" data-testid="LightModeIcon"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5M2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1m18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1M11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1m0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1M5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0z"></path></svg><style data-emotion="css 13m6tje">.css-13m6tje{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;color:white;font-size:14px;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium darkToggleIcon_ekgs css-13m6tje" focusable="false" aria-hidden="true" viewbox="0 0 24 24" data-testid="DarkModeIcon"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1"></path></svg></span></div></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a href="../../../../index.htm" target="_blank" rel="noopener noreferrer" tabindex="-1" class="sidebarLogo_isFc"><img src="../../../img/nt-black-large.webp" alt="PoseiTrader Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="../../../img/nt-white-large.webp" alt="PoseiTrader Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b></b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="../../index.htm">PoseiTrader Documentation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="../../getting_started/index.htm">Getting Started</a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="../index.htm">Concepts</a><button aria-label="Collapse sidebar category &#x27;Concepts&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../overview/index.htm">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../architecture/index.htm">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../actors/index.htm">Actors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../strategies/index.htm">Strategies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="index.htm">Instruments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../data/index.htm">Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../execution/index.htm">Execution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../orders/index.htm">Orders</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../cache/index.htm">Cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../message_bus/index.htm">Message Bus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../portfolio/index.htm">Portfolio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../logging/index.htm">Logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../backtesting/index.htm">Backtesting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../live/index.htm">Live Trading</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="../adapters/index.htm">Adapters</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="../../tutorials/index.htm">Tutorials</a><button aria-label="Expand sidebar category &#x27;Tutorials&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="../../integrations/index.htm">Integrations</a><button aria-label="Expand sidebar category &#x27;Integrations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="../../api_reference/index.htm">Python API</a><button aria-label="Expand sidebar category &#x27;Python API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="../../../core-nightly/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK">Rust API<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="../../developer_guide/index.htm">Developer Guide</a><button aria-label="Expand sidebar category &#x27;Developer Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="../index.htm"><span>Concepts</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Instruments</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: nightly</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Instruments</h1></header>
<p>The <code>Instrument</code> base class represents the core specification for any tradable asset/contract. There are
currently a number of subclasses representing a range of <em>asset classes</em> and <em>instrument classes</em> which are supported by the platform:</p>
<ul>
<li><code>Equity</code> (generic Equity)</li>
<li><code>FuturesContract</code> (generic Futures Contract)</li>
<li><code>FuturesSpread</code> (generic Futures Spread)</li>
<li><code>OptionContract</code> (generic Option Contract)</li>
<li><code>OptionSpread</code> (generic Option Spread)</li>
<li><code>BinaryOption</code> (generic Binary Option instrument)</li>
<li><code>Cfd</code> (Contract for Difference instrument)</li>
<li><code>Commodity</code> (commodity instrument in a spot/cash market)</li>
<li><code>CurrencyPair</code> (represents a Fiat FX or Cryptocurrency pair in a spot/cash market)</li>
<li><code>CryptoOption</code> (Crypto Option instrument)</li>
<li><code>CryptoPerpetual</code> (Perpetual Futures Contract a.k.a. Perpetual Swap)</li>
<li><code>CryptoFuture</code> (Deliverable Futures Contract with Crypto assets as underlying, and for price quotes and settlement)</li>
<li><code>IndexInstrument</code> (generic Index instrument)</li>
<li><code>BettingInstrument</code> (Sports, gaming, or other betting)</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="symbology">Symbology<a href="#symbology" class="hash-link" aria-label="Direct link to Symbology" title="Direct link to Symbology">​</a></h2>
<p>All instruments should have a unique <code>InstrumentId</code>, which is made up of both the native symbol, and venue ID, separated by a period.
For example, on the Binance Futures crypto exchange, the Ethereum Perpetual Futures Contract has the instrument ID <code>ETHUSDT-PERP.BINANCE</code>.</p>
<p>All native symbols <em>should</em> be unique for a venue (this is not always the case e.g. Binance share native symbols between spot and futures markets),
and the <code>{symbol.venue}</code> combination <em>must</em> be unique for a Posei system.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewbox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>The correct instrument must be matched to a market dataset such as ticks or order book data for logically sound operation.
An incorrectly specified instrument may truncate data or otherwise produce surprising results.</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="backtesting">Backtesting<a href="#backtesting" class="hash-link" aria-label="Direct link to Backtesting" title="Direct link to Backtesting">​</a></h2>
<p>Generic test instruments can be instantiated through the <code>TestInstrumentProvider</code>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">test_kit</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">providers </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> TestInstrumentProvider</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">audusd </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> TestInstrumentProvider</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">default_fx_ccy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;AUD/USD&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre></div></div>
<p>Exchange specific instruments can be discovered from live exchange data using an adapters <code>InstrumentProvider</code>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">adapters</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">binance</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">spot</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">providers </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> BinanceSpotInstrumentProvider</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">model </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> InstrumentId</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">provider </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> BinanceSpotInstrumentProvider</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">client</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">binance_http_client</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">await</span><span class="token plain"> provider</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">load_all_async</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">btcusdt </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> InstrumentId</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">from_str</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;BTCUSDT.BINANCE&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">instrument </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> provider</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">find</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">btcusdt</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre></div></div>
<p>Or flexibly defined by the user through an <code>Instrument</code> constructor, or one of its more specific subclasses:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">instruments </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> Instrument</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">instrument </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Instrument</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># &lt;-- provide all necessary parameters</span><br></span></code></pre></div></div>
<p>See the full instrument <a href="../../api_reference/model/instruments/index.htm">API Reference</a>.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="live-trading">Live trading<a href="#live-trading" class="hash-link" aria-label="Direct link to Live trading" title="Direct link to Live trading">​</a></h2>
<p>Live integration adapters have defined <code>InstrumentProvider</code> classes which work in an automated way to cache the
latest instrument definitions for the exchange. Refer to a particular <code>Instrument</code>
object by passing the matching <code>InstrumentId</code> to data and execution related methods and classes that require one.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="finding-instruments">Finding instruments<a href="#finding-instruments" class="hash-link" aria-label="Direct link to Finding instruments" title="Direct link to Finding instruments">​</a></h2>
<p>Since the same actor/strategy classes can be used for both backtest and live trading, you can
get instruments in exactly the same way through the central cache:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">model </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> InstrumentId</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">instrument_id </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> InstrumentId</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">from_str</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;ETHUSDT-PERP.BINANCE&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">instrument </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">cache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">instrument</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">instrument_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre></div></div>
<p>It&#x27;s also possible to subscribe to any changes to a particular instrument:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">subscribe_instrument</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">instrument_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre></div></div>
<p>Or subscribe to all instrument changes for an entire venue:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">model </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> Venue</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">binance </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Venue</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;BINANCE&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">subscribe_instruments</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">binance</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre></div></div>
<p>When an update to the instrument(s) is received by the <code>DataEngine</code>, the object(s) will
be passed to the actors/strategies <code>on_instrument()</code> method. A user can override this method with actions
to take upon receiving an instrument update:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">instruments </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> Instrument</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">on_instrument</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> instrument</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Instrument</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Take some action on an instrument update</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">pass</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="precisions-and-increments">Precisions and increments<a href="#precisions-and-increments" class="hash-link" aria-label="Direct link to Precisions and increments" title="Direct link to Precisions and increments">​</a></h2>
<p>The instrument objects are a convenient way to organize the specification of an
instrument through <em>read-only</em> properties. Correct price and quantity precisions, as well as
minimum price and size increments, multipliers and standard lot sizes, are available.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewbox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Most of these limits are checked by the Posei <code>RiskEngine</code>, otherwise invalid
values for prices and quantities <em>can</em> result in the exchange rejecting orders.</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="limits">Limits<a href="#limits" class="hash-link" aria-label="Direct link to Limits" title="Direct link to Limits">​</a></h2>
<p>Certain value limits are optional for instruments and can be <code>None</code>, these are exchange
dependent and can include:</p>
<ul>
<li><code>max_quantity</code> (maximum quantity for a single order)</li>
<li><code>min_quantity</code> (minimum quantity for a single order)</li>
<li><code>max_notional</code> (maximum value of a single order)</li>
<li><code>min_notional</code> (minimum value of a single order)</li>
<li><code>max_price</code> (maximum valid quote or order price)</li>
<li><code>min_price</code> (minimum valid quote or order price)</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewbox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Most of these limits are checked by the Posei <code>RiskEngine</code>, otherwise exceeding
published limits <em>can</em> result in the exchange rejecting orders.</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="prices-and-quantities">Prices and quantities<a href="#prices-and-quantities" class="hash-link" aria-label="Direct link to Prices and quantities" title="Direct link to Prices and quantities">​</a></h2>
<p>Instrument objects also offer a convenient way to create correct prices
and quantities based on given values.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">instrument </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">cache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">instrument</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">instrument_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">price </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> instrument</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">make_price</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">0.90500</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">quantity </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> instrument</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">make_qty</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">150</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewbox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>The above is the recommended method for creating valid prices and quantities,
such as when passing them to the order factory to create an order.</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="margins-and-fees">Margins and fees<a href="#margins-and-fees" class="hash-link" aria-label="Direct link to Margins and fees" title="Direct link to Margins and fees">​</a></h2>
<p>Margin calculations are handled by the <code>MarginAccount</code> class. This section explains how margins work and introduces key concepts you need to know.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="when-margins-apply">When margins apply?<a href="#when-margins-apply" class="hash-link" aria-label="Direct link to When margins apply?" title="Direct link to When margins apply?">​</a></h3>
<p>Each exchange (e.g., CME or Binance) operates with a specific account type that determines whether margin calculations are applicable.
When setting up an exchange venue, you&#x27;ll specify one of these account types:</p>
<ul>
<li><code>AccountType.MARGIN</code>: Accounts that use margin calculations, which are explained below.</li>
<li><code>AccountType.CASH</code>: Simple accounts where margin calculations do not apply.</li>
<li><code>AccountType.BETTING</code>: Accounts designed for betting, which also do not involve margin calculations.</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="vocabulary">Vocabulary<a href="#vocabulary" class="hash-link" aria-label="Direct link to Vocabulary" title="Direct link to Vocabulary">​</a></h3>
<p>To understand trading on margin, let’s start with some key terms:</p>
<p><strong>Notional Value</strong>: The total contract value in the quote currency. It represents the full market value of your position. For example, with EUR/USD futures on CME (symbol 6E).</p>
<ul>
<li>Each contract represents 125,000 EUR (EUR is base currency, USD is quote currency).</li>
<li>If the current market price is 1.1000, the notional value equals 125,000 EUR × 1.1000 (price of EUR/USD) = 137,500 USD.</li>
</ul>
<p><strong>Leverage</strong> (<code>leverage</code>): The ratio that determines how much market exposure you can control relative to your account deposit. For example, with 10× leverage, you can control 10,000 USD worth of positions with just 1,000 USD in your account.</p>
<p><strong>Initial Margin</strong> (<code>margin_init</code>): The margin rate required to open a position. It represents the minimum amount of funds that must be available in your account to open new positions. This is only a pre-check — no funds are actually locked.</p>
<p><strong>Maintenance Margin</strong> (<code>margin_maint</code>): The margin rate required to keep a position open. This amount is locked in your account to maintain the position. It is always lower than the initial margin. You can view the total blocked funds (sum of maintenance margins for open positions) using the following in your strategy:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">portfolio</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">balances_locked</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">venue</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre></div></div>
<p><strong>Maker/Taker Fees</strong>: The fees charged by exchanges based on your order&#x27;s interaction with the market:</p>
<ul>
<li>Maker Fee (<code>maker_fee</code>): A fee (typically lower) charged when you &quot;make&quot; liquidity by placing an order that remains on the order book. For example, a limit buy order below the current price adds liquidity, and the <em>maker</em> fee applies when it fills.</li>
<li>Taker Fee (<code>taker_fee</code>): A fee (typically higher) charged when you &quot;take&quot; liquidity by placing an order that executes immediately. For instance, a market buy order or a limit buy above the current price removes liquidity, and the <em>taker</em> fee applies.</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewbox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Not all exchanges or instruments implement maker/taker fees. If absent, set both <code>maker_fee</code> and <code>taker_fee</code> to 0 for the <code>Instrument</code> (e.g., <code>FuturesContract</code>, <code>Equity</code>, <code>CurrencyPair</code>, <code>Commodity</code>, <code>Cfd</code>, <code>BinaryOption</code>, <code>BettingInstrument</code>).</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="margin-calculation-formula">Margin calculation formula<a href="#margin-calculation-formula" class="hash-link" aria-label="Direct link to Margin calculation formula" title="Direct link to Margin calculation formula">​</a></h3>
<p>The <code>MarginAccount</code> class calculates margins using the following formulas:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"># Initial margin calculation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">margin_init </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">notional_value </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> leverage </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> margin_init</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">notional_value </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> leverage </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> taker_fee</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Maintenance margin calculation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">margin_maint </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">notional_value </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> leverage </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> margin_maint</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">notional_value </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> leverage </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> taker_fee</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre></div></div>
<p><strong>Key Points</strong>:</p>
<ul>
<li>Both formulas follow the same structure but use their respective margin rates (<code>margin_init</code> and <code>margin_maint</code>).</li>
<li>Each formula consists of two parts:
<ul>
<li><strong>Primary margin calculation</strong>: Based on notional value, leverage, and margin rate.</li>
<li><strong>Fee Adjustment</strong>: Accounts for the maker/taker fee.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="implementation-details">Implementation details<a href="#implementation-details" class="hash-link" aria-label="Direct link to Implementation details" title="Direct link to Implementation details">​</a></h3>
<p>For those interested in exploring the technical implementation:</p>
<ul>
<li><a href="https://github.com/poseisysstems/blob/develop/posei_trader/accounting/accounts/margin.pyx" target="_blank" rel="noopener noreferrer">posei_trader/accounting/accounts/margin.pyx</a></li>
<li>Key methods: <code>calculate_margin_init(self, ...)</code> and <code>calculate_margin_maint(self, ...)</code></li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="commissions">Commissions<a href="#commissions" class="hash-link" aria-label="Direct link to Commissions" title="Direct link to Commissions">​</a></h2>
<p>Trading commissions represent the fees charged by exchanges or brokers for executing trades.
While maker/taker fees are common in cryptocurrency markets, traditional exchanges like CME often
employ other fee structures, such as per-contract commissions.
PoseiTrader supports multiple commission models to accommodate diverse fee structures across different markets.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="built-in-fee-models">Built-in Fee Models<a href="#built-in-fee-models" class="hash-link" aria-label="Direct link to Built-in Fee Models" title="Direct link to Built-in Fee Models">​</a></h3>
<p>The framework provides two built-in fee model implementations:</p>
<ol>
<li><code>MakerTakerFeeModel</code>: Implements the maker/taker fee structure common in cryptocurrency exchanges, where fees are
calculated as a percentage of the trade value.</li>
<li><code>FixedFeeModel</code>: Applies a fixed commission per trade, regardless of the trade size.</li>
</ol>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="creating-custom-fee-models">Creating Custom Fee Models<a href="#creating-custom-fee-models" class="hash-link" aria-label="Direct link to Creating Custom Fee Models" title="Direct link to Creating Custom Fee Models">​</a></h3>
<p>While the built-in fee models cover common scenarios, you might encounter situations requiring specific commission structures.
PoseiTrader&#x27;s flexible architecture allows you to implement custom fee models by inheriting from the base <code>FeeModel</code> class.</p>
<p>For example, if you&#x27;re trading futures on exchanges that charge per-contract commissions (like CME), you can implement
a custom fee model. When creating custom fee models, we inherit from the <code>FeeModel</code> base class, which is implemented
in Cython for performance reasons. This Cython implementation is reflected in the parameter naming convention,
where type information is incorporated into parameter names using underscores (like <code>Order_order</code> or <code>Quantity_fill_qty</code>).</p>
<p>While these parameter names might look unusual to Python developers, they&#x27;re a result of Cython&#x27;s type system and help
maintain consistency with the framework&#x27;s core components. Here&#x27;s how you could create a per-contract commission model:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">PerContractFeeModel</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">FeeModel</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">__init__</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> commission</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Money</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token builtin" style="color:rgb(86, 156, 214)">super</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">commission </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> commission</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">get_commission</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Order_order</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Quantity_fill_qty</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Price_fill_px</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Instrument_instrument</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        total_commission </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Money</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">commission </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> Quantity_fill_qty</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">commission</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">currency</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> total_commission</span><br></span></code></pre></div></div>
<p>This custom implementation calculates the total commission by multiplying a <code>fixed per-contract fee</code> by the <code>number of contracts</code> traded. The <code>get_commission(...)</code> method receives information about the order, fill quantity, fill price
and instrument, allowing for flexible commission calculations based on these parameters.</p>
<p>Our new class <code>PerContractFeeModel</code> inherits class <code>FeeModel</code>, which is implemented in Cython,
so notice the Cython-style parameter names in the method signature:</p>
<ul>
<li><code>Order_order</code>: The order object, with type prefix <code>Order_</code>.</li>
<li><code>Quantity_fill_qty</code>: The fill quantity, with type prefix <code>Quantity_</code>.</li>
<li><code>Price_fill_px</code>: The fill price, with type prefix <code>Price_</code>.</li>
<li><code>Instrument_instrument</code>: The instrument object, with type prefix <code>Instrument_</code>.</li>
</ul>
<p>These parameter names follow PoseiTrader&#x27;s Cython naming conventions, where the prefix indicates the expected type.
While this might seem verbose compared to typical Python naming conventions, it ensures type safety and consistency
with the framework&#x27;s Cython codebase.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="using-fee-models-in-practice">Using Fee Models in Practice<a href="#using-fee-models-in-practice" class="hash-link" aria-label="Direct link to Using Fee Models in Practice" title="Direct link to Using Fee Models in Practice">​</a></h3>
<p>To use any fee model in your trading system, whether built-in or custom, you specify it when setting up the venue.
Here&#x27;s an example using the custom per-contract fee model:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">currencies </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> USD</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">objects </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> Money</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Currency</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">engine</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">add_venue</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    venue</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">venue</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    oms_type</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">OmsType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">NETTING</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    account_type</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">AccountType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">MARGIN</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    base_currency</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">USD</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    fee_model</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">PerContractFeeModel</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">Money</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">2.50</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> USD</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># 2.50 USD per contract</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    starting_balances</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">Money</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1_000_000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> USD</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Starting with 1,000,000 USD balance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewbox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>When implementing custom fee models, ensure they accurately reflect the fee structure of your target exchange.
Even small discrepancies in commission calculations can significantly impact strategy performance metrics during backtesting.</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="additional-info">Additional info<a href="#additional-info" class="hash-link" aria-label="Direct link to Additional info" title="Direct link to Additional info">​</a></h2>
<p>The raw instrument definition as provided by the exchange (typically from JSON serialized data) is also
included as a generic Python dictionary. This is to retain all information
which is not necessarily part of the unified Posei API, and is available to the user
at runtime by calling the <code>.info</code> property.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="synthetic-instruments">Synthetic Instruments<a href="#synthetic-instruments" class="hash-link" aria-label="Direct link to Synthetic Instruments" title="Direct link to Synthetic Instruments">​</a></h2>
<p>The platform supports creating customized synthetic instruments, which can generate synthetic quote
and trades. These are useful for:</p>
<ul>
<li>Enabling <code>Actor</code> and <code>Strategy</code> components to subscribe to quote or trade feeds.</li>
<li>Triggering emulated orders.</li>
<li>Constructing bars from synthetic quotes or trades.</li>
</ul>
<p>Synthetic instruments cannot be traded directly, as they are constructs that only exist locally
within the platform. They serve as analytical tools, providing useful metrics based on their component
instruments.</p>
<p>In the future, we plan to support order management for synthetic instruments, enabling trading of
their component instruments based on the synthetic instrument&#x27;s behavior.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewbox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>The venue for a synthetic instrument is always designated as <code>&#x27;SYNTH&#x27;</code>.</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="formula">Formula<a href="#formula" class="hash-link" aria-label="Direct link to Formula" title="Direct link to Formula">​</a></h3>
<p>A synthetic instrument is composed of a combination of two or more component instruments (which
can include instruments from multiple venues), as well as a &quot;derivation formula&quot;.
Utilizing the dynamic expression engine powered by the <a href="https://github.com/ISibboI/evalexpr" target="_blank" rel="noopener noreferrer">evalexpr</a>
Rust crate, the platform can evaluate the formula to calculate the latest synthetic price tick
from the incoming component instrument prices.</p>
<p>See the <code>evalexpr</code> documentation for a full description of available features, operators and precedence.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewbox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Before defining a new synthetic instrument, ensure that all component instruments are already defined and exist in the cache.</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="subscribing">Subscribing<a href="#subscribing" class="hash-link" aria-label="Direct link to Subscribing" title="Direct link to Subscribing">​</a></h3>
<p>The following example demonstrates the creation of a new synthetic instrument with an actor/strategy.
This synthetic instrument will represent a simple spread between Bitcoin and
Ethereum spot prices on Binance. For this example, it is assumed that spot instruments for
<code>BTCUSDT.BINANCE</code> and <code>ETHUSDT.BINANCE</code> are already present in the cache.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">instruments </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> SyntheticInstrument</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">btcusdt_binance_id </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> InstrumentId</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">from_str</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;BTCUSDT.BINANCE&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">ethusdt_binance_id </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> InstrumentId</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">from_str</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;ETHUSDT.BINANCE&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Define the synthetic instrument</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">synthetic </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> SyntheticInstrument</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    symbol</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">Symbol</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;BTC-ETH:BINANCE&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    price_precision</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    components</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        btcusdt_binance_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        ethusdt_binance_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    formula</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string-interpolation string" style="color:rgb(206, 145, 120)">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token string-interpolation interpolation">btcusdt_binance_id</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-interpolation string" style="color:rgb(206, 145, 120)"> - </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token string-interpolation interpolation">ethusdt_binance_id</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-interpolation string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ts_event</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">clock</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">timestamp_ns</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ts_init</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">clock</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">timestamp_ns</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Recommended to store the synthetic instruments ID somewhere</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_synthetic_id </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> synthetic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token builtin" style="color:rgb(86, 156, 214)">id</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Add the synthetic instrument for use by other components</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">add_synthetic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">synthetic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Subscribe to quotes for the synthetic instrument</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">subscribe_quote_ticks</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_synthetic_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewbox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The <code>instrument_id</code> for the synthetic instrument in the above example will be structured as <code>{symbol}.{SYNTH}</code>, resulting in <code>&#x27;BTC-ETH:BINANCE.SYNTH&#x27;</code>.</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="updating-formulas">Updating formulas<a href="#updating-formulas" class="hash-link" aria-label="Direct link to Updating formulas" title="Direct link to Updating formulas">​</a></h3>
<p>It&#x27;s also possible to update a synthetic instrument formulas at any time. The following example
shows how to achieve this with an actor/strategy.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain"># Recover the synthetic instrument from the cache (assuming `synthetic_id` was assigned)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">synthetic = self.cache.synthetic(self._synthetic_id)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># Update the formula, here is a simple example of just taking the average</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">new_formula = &quot;(BTCUSDT.BINANCE + ETHUSDT.BINANCE) / 2&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">synthetic.change_formula(new_formula)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># Now update the synthetic instrument</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">self.update_synthetic(synthetic)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="trigger-instrument-ids">Trigger instrument IDs<a href="#trigger-instrument-ids" class="hash-link" aria-label="Direct link to Trigger instrument IDs" title="Direct link to Trigger instrument IDs">​</a></h3>
<p>The platform allows for emulated orders to be triggered based on synthetic instrument prices. In
the following example, we build upon the previous one to submit a new emulated order.
This order will be retained in the emulator until a trigger from synthetic quotes releases it.
It will then be submitted to Binance as a MARKET order:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">order </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">strategy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">order_factory</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">limit</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    instrument_id</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">ETHUSDT_BINANCE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token builtin" style="color:rgb(86, 156, 214)">id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    order_side</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">OrderSide</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">BUY</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    quantity</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">Quantity</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">from_str</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;1.5&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    price</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">Price</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">from_str</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;30000.00000000&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># &lt;-- Synthetic instrument price</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    emulation_trigger</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">TriggerType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">DEFAULT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    trigger_instrument_id</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_synthetic_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># &lt;-- Synthetic instrument identifier</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">strategy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">submit_order</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">order</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="error-handling">Error handling<a href="#error-handling" class="hash-link" aria-label="Direct link to Error handling" title="Direct link to Error handling">​</a></h3>
<p>Considerable effort has been made to validate inputs, including the derivation formula for
synthetic instruments. Despite this, caution is advised as invalid or erroneous inputs may lead to
undefined behavior.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewbox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>See the <code>SyntheticInstrument</code> <a href="/docs/api_reference/model/instruments.md#class-syntheticinstrument-1">API reference</a>
for a detailed understanding of input requirements and potential exceptions.</p></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="../strategies/index.htm"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Strategies</div></a><a class="pagination-nav__link pagination-nav__link--next" href="../data/index.htm"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Data</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#symbology" class="table-of-contents__link toc-highlight">Symbology</a></li><li><a href="#backtesting" class="table-of-contents__link toc-highlight">Backtesting</a></li><li><a href="#live-trading" class="table-of-contents__link toc-highlight">Live trading</a></li><li><a href="#finding-instruments" class="table-of-contents__link toc-highlight">Finding instruments</a></li><li><a href="#precisions-and-increments" class="table-of-contents__link toc-highlight">Precisions and increments</a></li><li><a href="#limits" class="table-of-contents__link toc-highlight">Limits</a></li><li><a href="#prices-and-quantities" class="table-of-contents__link toc-highlight">Prices and quantities</a></li><li><a href="#margins-and-fees" class="table-of-contents__link toc-highlight">Margins and fees</a><ul><li><a href="#when-margins-apply" class="table-of-contents__link toc-highlight">When margins apply?</a></li><li><a href="#vocabulary" class="table-of-contents__link toc-highlight">Vocabulary</a></li><li><a href="#margin-calculation-formula" class="table-of-contents__link toc-highlight">Margin calculation formula</a></li><li><a href="#implementation-details" class="table-of-contents__link toc-highlight">Implementation details</a></li></ul></li><li><a href="#commissions" class="table-of-contents__link toc-highlight">Commissions</a><ul><li><a href="#built-in-fee-models" class="table-of-contents__link toc-highlight">Built-in Fee Models</a></li><li><a href="#creating-custom-fee-models" class="table-of-contents__link toc-highlight">Creating Custom Fee Models</a></li><li><a href="#using-fee-models-in-practice" class="table-of-contents__link toc-highlight">Using Fee Models in Practice</a></li></ul></li><li><a href="#additional-info" class="table-of-contents__link toc-highlight">Additional info</a></li><li><a href="#synthetic-instruments" class="table-of-contents__link toc-highlight">Synthetic Instruments</a><ul><li><a href="#formula" class="table-of-contents__link toc-highlight">Formula</a></li><li><a href="#subscribing" class="table-of-contents__link toc-highlight">Subscribing</a></li><li><a href="#updating-formulas" class="table-of-contents__link toc-highlight">Updating formulas</a></li><li><a href="#trigger-instrument-ids" class="table-of-contents__link toc-highlight">Trigger instrument IDs</a></li><li><a href="#error-handling" class="table-of-contents__link toc-highlight">Error handling</a></li></ul></li></ul></div></div></div><div class="footer-wrapper MuiBox-root css-0"><div class="social-footer-box MuiBox-root css-0"><style data-emotion="css 17rjyz3">.css-17rjyz3{-webkit-text-decoration:underline;text-decoration:underline;text-decoration-color:rgba(25, 118, 210, 0.4);padding:12px;margin-right:10px;}.css-17rjyz3:hover{text-decoration-color:inherit;}</style><style data-emotion="css jl1bw5">.css-jl1bw5{margin:0;font:inherit;color:#1976d2;-webkit-text-decoration:underline;text-decoration:underline;text-decoration-color:rgba(25, 118, 210, 0.4);padding:12px;margin-right:10px;}.css-jl1bw5:hover{text-decoration-color:inherit;}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways github-footer css-jl1bw5" href="https://github.com/poseisysstems" target="_blank"></a><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways discord-footer css-jl1bw5" href="" target="_blank"></a><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways linkedin-footer css-jl1bw5" href="https://www.linkedin.com/company/poseitrader/" target="_blank"></a><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways x-footer css-jl1bw5" href="https://twitter.com/PoseiTrader" target="_blank"></a></div><div class="footer-copyright">© 2025 Posei Systems Pty Ltd. All rights reserved.</div></div></div></div></main></div></div></div></div>
</body>
</html>