<!DOCTYPE html>
<html
  lang="en"
  dir="ltr"
  class="docs-wrapper plugin-docs plugin-id-default docs-version-latest docs-doc-page docs-doc-id-concepts/backtesting"
  data-has-hydrated="false"
>
  <head>
    <meta charset="UTF-8" />
    <meta name="generator" content="Docusaurus v3.8.1" />
    <title data-rh="true">Backtesting | PoseiTrader Documentation</title>
    <meta
      data-rh="true"
      name="viewport"
      content="width=device-width,initial-scale=1"
    />
    <meta data-rh="true" name="twitter:card" content="summary_large_image" />
    <meta
      data-rh="true"
      property="og:image"
      content="docs/latestimg/docusaurus-social-card.jpg"
    />
    <meta
      data-rh="true"
      name="twitter:image"
      content="docs/latestimg/docusaurus-social-card.jpg"
    />
    <meta
      data-rh="true"
      property="og:url"
      content="docs/latestlatest/concepts/backtesting"
    />
    <meta data-rh="true" property="og:locale" content="en" />
    <meta data-rh="true" name="docusaurus_locale" content="en" />
    <meta data-rh="true" name="docsearch:language" content="en" />
    <meta
      data-rh="true"
      name="keywords"
      content="Open-source trading platform, Algorithmic trading software, Event-driven backtesting, Live trading with no code changes, Trade any asset class, Low-latency trading execution, Python API for trading strategies, Custom market data integration, Futures and options trading, Crypto spot and derivatives trading, Equities trading simulation, FX spot trading, Sports betting markets trading, Fast backtesting strategies, Advanced trading orders, Rust-based trading platform, High-performance trading system, Nanosecond resolution market simulation, Trading across multiple venues, Trading platform for hedge funds, Seamless data integration, Customizable trading strategies, AI and ML trading strategies, Posei trading platform, Multi-venue trading, Unlimited backtesting strategies, Fast trading execution solutions, Realistic market simulations, Seamless trading API integration, PoseiTrader Documentation, Docs, PoseiTrader Docs"
    />
    <meta data-rh="true" name="title" content="PoseiTrader Documentation" />
    <meta data-rh="true" name="og:title" content="PoseiTrader Documentation" />
    <meta
      data-rh="true"
      name="og:description"
      content="PoseiTrader is a high-performance platform for automating trading strategies, built on the powerful Posei framework for backtesting and real-time trading."
    />
    <meta data-rh="true" name="og:image" content="img/preview.png" />
    <meta data-rh="true" name="og:url" content="/docs/latest" />
    <meta data-rh="true" name="docusaurus_version" content="latest" />
    <meta data-rh="true" name="docusaurus_tag" content="docs-default-latest" />
    <meta data-rh="true" name="docsearch:version" content="latest" />
    <meta
      data-rh="true"
      name="docsearch:docusaurus_tag"
      content="docs-default-latest"
    />
    <meta
      data-rh="true"
      property="og:title"
      content="Backtesting | PoseiTrader Documentation"
    />
    <meta
      data-rh="true"
      name="description"
      content="Backtesting with PoseiTrader is a methodical simulation process that replicates trading"
    />
    <meta
      data-rh="true"
      property="og:description"
      content="Backtesting with PoseiTrader is a methodical simulation process that replicates trading"
    />
    <link data-rh="true" rel="icon" href="../../../img/shell.ico" />
    <link data-rh="true" rel="canonical" href="index.htm" />
    <link data-rh="true" rel="alternate" href="index.htm" hreflang="en" />
    <link
      data-rh="true"
      rel="alternate"
      href="index.htm"
      hreflang="x-default"
    />
    <link
      data-rh="true"
      rel="preconnect"
      href="https://CWRKEEL01M-dsn.algolia.net"
      crossorigin="anonymous"
    />
    <script data-rh="true" type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Concepts",
            "item": "docs/latestlatest/concepts/"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "Backtesting",
            "item": "docs/latestlatest/concepts/backtesting"
          }
        ]
      }
    </script>
    <link
      rel="search"
      type="application/opensearchdescription+xml"
      title="PoseiTrader Documentation"
      href="../../../opensearch.xml"
    />
    <script>
      !(function () {
        var t = window.location.pathname;
        if (
          t.startsWith("/docs") &&
          !t.startsWith("/docs/latest") &&
          !t.startsWith("/docs/nightly")
        ) {
          var s = t.replace("/docs", "/docs/latest");
          window.location.href = s;
        }
      })();
    </script>
    <link rel="preconnect" href="https://www.google-analytics.com" />
    <link rel="preconnect" href="https://www.googletagmanager.com" />
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-TR4XK597XK"
    ></script>
    <script>
      function gtag() {
        dataLayer.push(arguments);
      }
      (window.dataLayer = window.dataLayer || []),
        gtag("js", new Date()),
        gtag("config", "G-TR4XK597XK", { anonymize_ip: !0 });
    </script>
    <link rel="stylesheet" href="../../../assets/css/styles.0f0f692e.css" />
    <script
      src="../../../assets/js/runtime~main.92b727d5.js"
      defer="defer"
    ></script>
    <script src="../../../assets/js/main.1cd42d85.js" defer="defer"></script>
  </head>
  <body class="navigation-with-keyboard">
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none">
      <defs>
        <symbol id="theme-svg-external-link" viewbox="0 0 24 24">
          <path
            fill="currentColor"
            d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"
          ></path>
        </symbol>
      </defs>
    </svg>
    <script>
      !(function () {
        var t = "dark";
        var e =
          (function () {
            try {
              return new URLSearchParams(window.location.search).get(
                "docusaurus-theme"
              );
            } catch (t) {}
          })() ||
          (function () {
            try {
              return window.localStorage.getItem("theme");
            } catch (t) {}
          })();
        document.documentElement.setAttribute("data-theme", e || t),
          document.documentElement.setAttribute("data-theme-choice", e || t);
      })(),
        (function () {
          try {
            const c = new URLSearchParams(window.location.search).entries();
            for (var [t, e] of c)
              if (t.startsWith("docusaurus-data-")) {
                var a = t.replace("docusaurus-data-", "data-");
                document.documentElement.setAttribute(a, e);
              }
          } catch (t) {}
        })();
    </script>
    <div id="__docusaurus">
      <div role="region" aria-label="Skip to main content">
        <a
          class="skipToContent_fXgn"
          href="#__docusaurus_skipToContent_fallback"
          >Skip to main content</a
        >
      </div>
      <nav
        aria-label="Main"
        class="theme-layout-navbar navbar navbar--fixed-top navbarHideable_m1mJ"
      >
        <div class="navbar__inner">
          <div class="theme-layout-navbar-left navbar__items">
            <button
              aria-label="Toggle navigation bar"
              aria-expanded="false"
              class="navbar__toggle clean-btn"
              type="button"
            >
              <svg
                width="30"
                height="30"
                viewbox="0 0 30 30"
                aria-hidden="true"
              >
                <path
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-miterlimit="10"
                  stroke-width="2"
                  d="M4 7h22M4 15h22M4 23h22"
                ></path>
              </svg></button
            ><a
              href="../../../../index.htm"
              target="_blank"
              rel="noopener noreferrer"
              class="navbar__brand"
              ><div class="navbar__logo">
                <img
                  src="../../../img/nt-black-large.webp"
                  alt="PoseiTrader Logo"
                  class="themedComponent_mlkZ themedComponent--light_NVdE"
                /><img
                  src="../../../img/nt-white-large.webp"
                  alt="PoseiTrader Logo"
                  class="themedComponent_mlkZ themedComponent--dark_xIcU"
                />
              </div>
              <b class="navbar__title text--truncate"></b
            ></a>
            <div class="navbar__item dropdown dropdown--hoverable">
              <a
                href="#"
                aria-haspopup="true"
                aria-expanded="false"
                role="button"
                class="navbar__link"
                >Version</a
              >
              <ul class="dropdown__menu">
                <li>
                  <a
                    aria-current="page"
                    class="dropdown__link dropdown__link--active"
                    href="../../index.htm"
                    >latest</a
                  >
                </li>
                <li>
                  <a class="dropdown__link" href="../../../nightly/index.html"
                    >nightly</a
                  >
                </li>
              </ul>
            </div>
            <div class="navbarSearchContainer_Bca1">
              <button
                type="button"
                class="DocSearch DocSearch-Button"
                aria-label="Search (Command+K)"
              >
                <span class="DocSearch-Button-Container"
                  ><svg
                    width="20"
                    height="20"
                    class="DocSearch-Search-Icon"
                    viewbox="0 0 20 20"
                    aria-hidden="true"
                  >
                    <path
                      d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z"
                      stroke="currentColor"
                      fill="none"
                      fill-rule="evenodd"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    ></path></svg
                  ><span class="DocSearch-Button-Placeholder"
                    >Search</span
                  ></span
                ><span class="DocSearch-Button-Keys"></span>
              </button>
            </div>
          </div>
          <div
            class="theme-layout-navbar-right navbar__items navbar__items--right"
          >
            <a
              href="https://github.com/poseisysstems"
              target="_blank"
              rel="noopener noreferrer"
              class="navbar__item navbar__link header-github-link common-social"
              aria-label="GitHub repository"
            ></a>
            <a
              href="https://twitter.com/PoseiTrader"
              target="_blank"
              rel="noopener noreferrer"
              class="navbar__item navbar__link header-x-link common-social"
              aria-label="X"
            ></a>
             
          </div>
        </div>
        <div role="presentation" class="navbar-sidebar__backdrop"></div>
      </nav>
      <div
        id="__docusaurus_skipToContent_fallback"
        class="theme-layout-main main-wrapper mainWrapper_z2l0"
      >
        <div class="docsWrapper_hBAB">
          <button
            aria-label="Scroll back to top"
            class="clean-btn theme-back-to-top-button backToTopButton_sjWU"
            type="button"
          ></button>
          <div class="docRoot_UBD9">
            <aside class="theme-doc-sidebar-container docSidebarContainer_YfHR">
              <div class="sidebarViewport_aRkj">
                <div class="sidebar_njMd sidebarWithHideableNavbar_wUlq">
                  <a
                    href="../../../../index.htm"
                    target="_blank"
                    rel="noopener noreferrer"
                    tabindex="-1"
                    class="sidebarLogo_isFc"
                    ><img
                      src="../../../img/nt-black-large.webp"
                      alt="PoseiTrader Logo"
                      class="themedComponent_mlkZ themedComponent--light_NVdE" /><img
                      src="../../../img/nt-white-large.webp"
                      alt="PoseiTrader Logo"
                      class="themedComponent_mlkZ themedComponent--dark_xIcU" /><b></b
                  ></a>
                  <nav
                    aria-label="Docs sidebar"
                    class="menu thin-scrollbar menu_SIkG"
                  >
                    <ul class="theme-doc-sidebar-menu menu__list">
                      <li
                        class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"
                      >
                        <a class="menu__link" href="../../index.htm"
                          >PoseiTrader Documentation</a
                        >
                      </li>
                      <li
                        class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"
                      >
                        <div class="menu__list-item-collapsible">
                          <a
                            class="menu__link menu__link--sublist"
                            href="../../getting_started/index.htm"
                            >Getting Started</a
                          ><button
                            aria-label="Expand sidebar category &#x27;Getting Started&#x27;"
                            aria-expanded="false"
                            type="button"
                            class="clean-btn menu__caret"
                          ></button>
                        </div>
                      </li>
                      <li
                        class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"
                      >
                        <div class="menu__list-item-collapsible">
                          <a
                            class="menu__link menu__link--sublist menu__link--active"
                            href="../index.htm"
                            >Concepts</a
                          ><button
                            aria-label="Collapse sidebar category &#x27;Concepts&#x27;"
                            aria-expanded="true"
                            type="button"
                            class="clean-btn menu__caret"
                          ></button>
                        </div>
                        <ul class="menu__list">
                          <li
                            class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"
                          >
                            <a
                              class="menu__link"
                              tabindex="0"
                              href="../overview/index.htm"
                              >Overview</a
                            >
                          </li>
                          <li
                            class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"
                          >
                            <a
                              class="menu__link"
                              tabindex="0"
                              href="../architecture/index.htm"
                              >Architecture</a
                            >
                          </li>
                          <li
                            class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"
                          >
                            <a
                              class="menu__link"
                              tabindex="0"
                              href="../actors/index.htm"
                              >Actors</a
                            >
                          </li>
                          <li
                            class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"
                          >
                            <a
                              class="menu__link"
                              tabindex="0"
                              href="../strategies/index.htm"
                              >Strategies</a
                            >
                          </li>
                          <li
                            class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"
                          >
                            <a
                              class="menu__link"
                              tabindex="0"
                              href="../instruments/index.htm"
                              >Instruments</a
                            >
                          </li>
                          <li
                            class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"
                          >
                            <a
                              class="menu__link"
                              tabindex="0"
                              href="../data/index.htm"
                              >Data</a
                            >
                          </li>
                          <li
                            class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"
                          >
                            <a
                              class="menu__link"
                              tabindex="0"
                              href="../execution/index.htm"
                              >Execution</a
                            >
                          </li>
                          <li
                            class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"
                          >
                            <a
                              class="menu__link"
                              tabindex="0"
                              href="../orders/index.htm"
                              >Orders</a
                            >
                          </li>
                          <li
                            class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"
                          >
                            <a
                              class="menu__link"
                              tabindex="0"
                              href="../cache/index.htm"
                              >Cache</a
                            >
                          </li>
                          <li
                            class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"
                          >
                            <a
                              class="menu__link"
                              tabindex="0"
                              href="../message_bus/index.htm"
                              >Message Bus</a
                            >
                          </li>
                          <li
                            class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"
                          >
                            <a
                              class="menu__link"
                              tabindex="0"
                              href="../portfolio/index.htm"
                              >Portfolio</a
                            >
                          </li>
                          <li
                            class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"
                          >
                            <a
                              class="menu__link"
                              tabindex="0"
                              href="../logging/index.htm"
                              >Logging</a
                            >
                          </li>
                          <li
                            class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"
                          >
                            <a
                              class="menu__link menu__link--active"
                              aria-current="page"
                              tabindex="0"
                              href="index.htm"
                              >Backtesting</a
                            >
                          </li>
                          <li
                            class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"
                          >
                            <a
                              class="menu__link"
                              tabindex="0"
                              href="../live/index.htm"
                              >Live Trading</a
                            >
                          </li>
                          <li
                            class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"
                          >
                            <a
                              class="menu__link"
                              tabindex="0"
                              href="../adapters/index.htm"
                              >Adapters</a
                            >
                          </li>
                        </ul>
                      </li>
                      <li
                        class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"
                      >
                        <div class="menu__list-item-collapsible">
                          <a
                            class="menu__link menu__link--sublist"
                            href="../../tutorials/index.htm"
                            >Tutorials</a
                          ><button
                            aria-label="Expand sidebar category &#x27;Tutorials&#x27;"
                            aria-expanded="false"
                            type="button"
                            class="clean-btn menu__caret"
                          ></button>
                        </div>
                      </li>
                      <li
                        class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"
                      >
                        <div class="menu__list-item-collapsible">
                          <a
                            class="menu__link menu__link--sublist"
                            href="../../integrations/index.htm"
                            >Integrations</a
                          ><button
                            aria-label="Expand sidebar category &#x27;Integrations&#x27;"
                            aria-expanded="false"
                            type="button"
                            class="clean-btn menu__caret"
                          ></button>
                        </div>
                      </li>
                      <li
                        class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"
                      >
                        <div class="menu__list-item-collapsible">
                          <a
                            class="menu__link menu__link--sublist"
                            href="../../api_reference/index.htm"
                            >Python API</a
                          ><button
                            aria-label="Expand sidebar category &#x27;Python API&#x27;"
                            aria-expanded="false"
                            type="button"
                            class="clean-btn menu__caret"
                          ></button>
                        </div>
                      </li>
                      <li
                        class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"
                      >
                        <a
                          href="../../../core-latest/index.html"
                          target="_blank"
                          rel="noopener noreferrer"
                          class="menu__link menuExternalLink_NmtK"
                          >Rust API<svg
                            width="13.5"
                            height="13.5"
                            aria-hidden="true"
                            class="iconExternalLink_nPIU"
                          >
                            <use href="#theme-svg-external-link"></use></svg
                        ></a>
                      </li>
                      <li
                        class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"
                      >
                        <div class="menu__list-item-collapsible">
                          <a
                            class="menu__link menu__link--sublist"
                            href="../../developer_guide/index.htm"
                            >Developer Guide</a
                          ><button
                            aria-label="Expand sidebar category &#x27;Developer Guide&#x27;"
                            aria-expanded="false"
                            type="button"
                            class="clean-btn menu__caret"
                          ></button>
                        </div>
                      </li>
                    </ul>
                  </nav>
                </div>
              </div>
            </aside>
            <main class="docMainContainer_TBSr">
              <div class="container padding-top--md padding-bottom--lg">
                <div>
                  <div class="row">
                    <div class="col docItemCol_VOVn">
                      <div class="docItemContainer_Djhp">
                        <article>
                          <nav
                            class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl"
                            aria-label="Breadcrumbs"
                          >
                            <ul class="breadcrumbs">
                              <li class="breadcrumbs__item">
                                <a class="breadcrumbs__link" href="../index.htm"
                                  ><span>Concepts</span></a
                                >
                              </li>
                              <li
                                class="breadcrumbs__item breadcrumbs__item--active"
                              >
                                <span class="breadcrumbs__link"
                                  >Backtesting</span
                                >
                              </li>
                            </ul>
                          </nav>
                          <span
                            class="theme-doc-version-badge badge badge--secondary"
                            >Version: latest</span
                          >
                          <div
                            class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"
                          >
                            <button
                              type="button"
                              class="clean-btn tocCollapsibleButton_TO0P"
                            >
                              On this page
                            </button>
                          </div>
                          <div class="theme-doc-markdown markdown">
                            <header><h1>Backtesting</h1></header>
                            <p>
                              Backtesting with PoseiTrader is a methodical
                              simulation process that replicates trading
                              activities using a specific system implementation.
                              This system is composed of various components
                              including the built-in engines,
                              <code>Cache</code>,
                              <a href="../message_bus/index.htm">MessageBus</a>,
                              <code>Portfolio</code>,
                              <a href="../actors/index.htm">Actors</a>,
                              <a href="../strategies/index.htm">Strategies</a>,
                              <a href="../execution/index.htm"
                                >Execution Algorithms</a
                              >, and other user-defined modules. The entire
                              trading simulation is predicated on a stream of
                              historical data processed by a
                              <code>BacktestEngine</code>. Once this data stream
                              is exhausted, the engine concludes its operation,
                              producing detailed results and performance metrics
                              for in-depth analysis.
                            </p>
                            <p>
                              It&#x27;s important to recognize that PoseiTrader
                              offers two distinct API levels for setting up and
                              conducting backtests:
                            </p>
                            <ul>
                              <li>
                                <strong>High-level API</strong>: Uses a
                                <code>BacktestNode</code> and configuration
                                objects (<code>BacktestEngine</code>s are used
                                internally).
                              </li>
                              <li>
                                <strong>Low-level API</strong>: Uses a
                                <code>BacktestEngine</code> directly with more
                                &quot;manual&quot; setup.
                              </li>
                            </ul>
                            <h2
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="choosing-an-api-level"
                            >
                              Choosing an API level<a
                                href="#choosing-an-api-level"
                                class="hash-link"
                                aria-label="Direct link to Choosing an API level"
                                title="Direct link to Choosing an API level"
                                >​</a
                              >
                            </h2>
                            <p>
                              Consider using the <strong>low-level</strong> API
                              when:
                            </p>
                            <ul>
                              <li>
                                Your entire data stream can be processed within
                                the available machine resources (e.g., RAM).
                              </li>
                              <li>
                                You prefer not to store data in the
                                Posei-specific Parquet format.
                              </li>
                              <li>
                                You have a specific need or preference to retain
                                raw data in its original format (e.g., CSV,
                                binary, etc.).
                              </li>
                              <li>
                                You require fine-grained control over the
                                <code>BacktestEngine</code>, such as the ability
                                to re-run backtests on identical datasets while
                                swapping out components (e.g., actors or
                                strategies) or adjusting parameter
                                configurations.
                              </li>
                            </ul>
                            <p>
                              Consider using the <strong>high-level</strong> API
                              when:
                            </p>
                            <ul>
                              <li>
                                Your data stream exceeds available memory,
                                requiring streaming data in batches.
                              </li>
                              <li>
                                You want to leverage the performance and
                                convenience of the
                                <code>ParquetDataCatalog</code> for storing data
                                in the Posei-specific Parquet format.
                              </li>
                              <li>
                                You value the flexibility and functionality of
                                passing configuration objects to define and
                                manage multiple backtest runs across various
                                engines simultaneously.
                              </li>
                            </ul>
                            <h2
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="low-level-api"
                            >
                              Low-level API<a
                                href="#low-level-api"
                                class="hash-link"
                                aria-label="Direct link to Low-level API"
                                title="Direct link to Low-level API"
                                >​</a
                              >
                            </h2>
                            <p>
                              The low-level API centers around a
                              <code>BacktestEngine</code>, where inputs are
                              initialized and added manually via a Python
                              script. An instantiated
                              <code>BacktestEngine</code> can accept the
                              following:
                            </p>
                            <ul>
                              <li>
                                Lists of <code>Data</code> objects, which are
                                automatically sorted into monotonic order based
                                on <code>ts_init</code>.
                              </li>
                              <li>Multiple venues, manually initialized.</li>
                              <li>
                                Multiple actors, manually initialized and added.
                              </li>
                              <li>
                                Multiple execution algorithms, manually
                                initialized and added.
                              </li>
                            </ul>
                            <p>
                              This approach offers detailed control over the
                              backtesting process, allowing you to manually
                              configure each component.
                            </p>
                            <h2
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="high-level-api"
                            >
                              High-level API<a
                                href="#high-level-api"
                                class="hash-link"
                                aria-label="Direct link to High-level API"
                                title="Direct link to High-level API"
                                >​</a
                              >
                            </h2>
                            <p>
                              The high-level API centers around a
                              <code>BacktestNode</code>, which orchestrates the
                              management of multiple
                              <code>BacktestEngine</code> instances, each
                              defined by a <code>BacktestRunConfig</code>.
                              Multiple configurations can be bundled into a list
                              and processed by the node in one run.
                            </p>
                            <p>
                              Each <code>BacktestRunConfig</code> object
                              consists of the following:
                            </p>
                            <ul>
                              <li>
                                A list of
                                <code>BacktestDataConfig</code> objects.
                              </li>
                              <li>
                                A list of
                                <code>BacktestVenueConfig</code> objects.
                              </li>
                              <li>
                                A list of
                                <code>ImportableActorConfig</code> objects.
                              </li>
                              <li>
                                A list of
                                <code>ImportableStrategyConfig</code> objects.
                              </li>
                              <li>
                                A list of
                                <code>ImportableExecAlgorithmConfig</code>
                                objects.
                              </li>
                              <li>
                                An optional
                                <code>ImportableControllerConfig</code> object.
                              </li>
                              <li>
                                An optional
                                <code>BacktestEngineConfig</code> object, with a
                                default configuration if not specified.
                              </li>
                            </ul>
                            <h2
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="data"
                            >
                              Data<a
                                href="#data"
                                class="hash-link"
                                aria-label="Direct link to Data"
                                title="Direct link to Data"
                                >​</a
                              >
                            </h2>
                            <p>
                              Data provided for backtesting drives the execution
                              flow. Since a variety of data types can be used,
                              it&#x27;s crucial that your venue configurations
                              align with the data being provided for
                              backtesting. Mismatches between data and
                              configuration can lead to unexpected behavior
                              during execution.
                            </p>
                            <p>
                              PoseiTrader is primarily designed and optimized
                              for order book data, which provides a complete
                              representation of every price level or order in
                              the market, reflecting the real-time behavior of a
                              trading venue. This ensures the highest level of
                              execution granularity and realism. However, if
                              granular order book data is either not available
                              or necessary, then the platform has the capability
                              of processing market data in the following
                              descending order of detail:
                            </p>
                            <ol>
                              <li>
                                <p>
                                  <strong
                                    >Order Book Data/Deltas (L3
                                    market-by-order)</strong
                                  >:
                                </p>
                                <ul>
                                  <li>
                                    Providing comprehensive market depth and
                                    detailed order flow, with visibility of all
                                    individual orders.
                                  </li>
                                </ul>
                              </li>
                              <li>
                                <p>
                                  <strong
                                    >Order Book Data/Deltas (L2
                                    market-by-price)</strong
                                  >:
                                </p>
                                <ul>
                                  <li>
                                    Providing market depth visibility across all
                                    price levels.
                                  </li>
                                </ul>
                              </li>
                              <li>
                                <p>
                                  <strong
                                    >Quote Ticks (L1 market-by-price)</strong
                                  >:
                                </p>
                                <ul>
                                  <li>
                                    Representing the &quot;top of the book&quot;
                                    by capturing only the best bid and ask
                                    prices and sizes.
                                  </li>
                                </ul>
                              </li>
                              <li>
                                <p><strong>Trade Ticks</strong>:</p>
                                <ul>
                                  <li>
                                    Reflecting actual executed trades, offering
                                    a precise view of transaction activity.
                                  </li>
                                </ul>
                              </li>
                              <li>
                                <p><strong>Bars</strong>:</p>
                                <ul>
                                  <li>
                                    Aggregating trading activity - typically
                                    over fixed time intervals, such as 1-minute,
                                    1-hour, or 1-day.
                                  </li>
                                </ul>
                              </li>
                            </ol>
                            <h3
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="choosing-data-cost-vs-accuracy"
                            >
                              Choosing data: Cost vs. Accuracy<a
                                href="#choosing-data-cost-vs-accuracy"
                                class="hash-link"
                                aria-label="Direct link to Choosing data: Cost vs. Accuracy"
                                title="Direct link to Choosing data: Cost vs. Accuracy"
                                >​</a
                              >
                            </h3>
                            <p>
                              For many trading strategies, bar data (e.g.,
                              1-minute) can be sufficient for backtesting and
                              strategy development. This is particularly
                              important because bar data is typically much more
                              accessible and cost-effective compared to tick or
                              order book data.
                            </p>
                            <p>
                              Given this practical reality, Posei is designed to
                              support bar-based backtesting with advanced
                              features that maximize simulation accuracy, even
                              when working with lower granularity data.
                            </p>
                            <div
                              class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"
                            >
                              <div class="admonitionHeading_Gvgb">
                                <span class="admonitionIcon_Rf37"
                                  ><svg viewbox="0 0 12 16">
                                    <path
                                      fill-rule="evenodd"
                                      d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"
                                    ></path></svg></span
                                >tip
                              </div>
                              <div class="admonitionContent_BuS1">
                                <p>
                                  For some trading strategies, it can be
                                  practical to start development with bar data
                                  to validate core trading ideas. If the
                                  strategy looks promising, but is more
                                  sensitive to precise execution timing (e.g.,
                                  requires fills at specific prices between OHLC
                                  levels, or uses tight take-profit/stop-loss
                                  levels), you can then invest in higher
                                  granularity data for more accurate validation.
                                </p>
                              </div>
                            </div>
                            <h2
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="venues"
                            >
                              Venues<a
                                href="#venues"
                                class="hash-link"
                                aria-label="Direct link to Venues"
                                title="Direct link to Venues"
                                >​</a
                              >
                            </h2>
                            <p>
                              When initializing a venue for backtesting, you
                              must specify its internal order
                              <code>book_type</code> for execution processing
                              from the following options:
                            </p>
                            <ul>
                              <li>
                                <code>L1_MBP</code>: Level 1 market-by-price
                                (default). Only the top level of the order book
                                is maintained.
                              </li>
                              <li>
                                <code>L2_MBP</code>: Level 2 market-by-price.
                                Order book depth is maintained, with a single
                                order aggregated per price level.
                              </li>
                              <li>
                                <code>L3_MBO</code>: Level 3 market-by-order.
                                Order book depth is maintained, with all
                                individual orders tracked as provided by the
                                data.
                              </li>
                            </ul>
                            <div
                              class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"
                            >
                              <div class="admonitionHeading_Gvgb">
                                <span class="admonitionIcon_Rf37"
                                  ><svg viewbox="0 0 14 16">
                                    <path
                                      fill-rule="evenodd"
                                      d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"
                                    ></path></svg></span
                                >note
                              </div>
                              <div class="admonitionContent_BuS1">
                                <p>
                                  The granularity of the data must match the
                                  specified order <code>book_type</code>. Posei
                                  cannot generate higher granularity data (L2 or
                                  L3) from lower-level data such as quotes,
                                  trades, or bars.
                                </p>
                              </div>
                            </div>
                            <div
                              class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"
                            >
                              <div class="admonitionHeading_Gvgb">
                                <span class="admonitionIcon_Rf37"
                                  ><svg viewbox="0 0 16 16">
                                    <path
                                      fill-rule="evenodd"
                                      d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"
                                    ></path></svg></span
                                >warning
                              </div>
                              <div class="admonitionContent_BuS1">
                                <p>
                                  If you specify <code>L2_MBP</code> or
                                  <code>L3_MBO</code> as the venue’s
                                  <code>book_type</code>, all non-order book
                                  data (such as quotes, trades, and bars) will
                                  be ignored for execution processing. This may
                                  cause orders to appear as though they are
                                  never filled. We are actively working on
                                  improved validation logic to prevent
                                  configuration and data mismatches.
                                </p>
                              </div>
                            </div>
                            <div
                              class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"
                            >
                              <div class="admonitionHeading_Gvgb">
                                <span class="admonitionIcon_Rf37"
                                  ><svg viewbox="0 0 16 16">
                                    <path
                                      fill-rule="evenodd"
                                      d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"
                                    ></path></svg></span
                                >warning
                              </div>
                              <div class="admonitionContent_BuS1">
                                <p>
                                  When providing L2 or higher order book data,
                                  ensure that the <code>book_type</code> is
                                  updated to reflect the data&#x27;s
                                  granularity. Failing to do so will result in
                                  data aggregation: L2 data will be reduced to a
                                  single order per level, and L1 data will
                                  reflect only top-of-book levels.
                                </p>
                              </div>
                            </div>
                            <h2
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="execution"
                            >
                              Execution<a
                                href="#execution"
                                class="hash-link"
                                aria-label="Direct link to Execution"
                                title="Direct link to Execution"
                                >​</a
                              >
                            </h2>
                            <h3
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="bar-based-execution"
                            >
                              Bar Based Execution<a
                                href="#bar-based-execution"
                                class="hash-link"
                                aria-label="Direct link to Bar Based Execution"
                                title="Direct link to Bar Based Execution"
                                >​</a
                              >
                            </h3>
                            <p>
                              Bar data provides a summary of market activity
                              with four key prices for each time period
                              (assuming bars are aggregated by trades):
                            </p>
                            <ul>
                              <li>
                                <strong>Open</strong>: opening price (first
                                trade)
                              </li>
                              <li>
                                <strong>High</strong>: highest price traded
                              </li>
                              <li><strong>Low</strong>: lowest price traded</li>
                              <li>
                                <strong>Close</strong>: closing price (last
                                trade)
                              </li>
                            </ul>
                            <p>
                              While this gives us an overview of price movement,
                              we lose some important details that we&#x27;d have
                              with more granular data:
                            </p>
                            <ul>
                              <li>
                                We don&#x27;t know in what order the market hit
                                the high and low prices.
                              </li>
                              <li>
                                We can&#x27;t see exactly when prices changed
                                within the time period.
                              </li>
                              <li>
                                We don&#x27;t know the actual sequence of trades
                                that occurred.
                              </li>
                            </ul>
                            <p>
                              This is why Posei processes bar data through a
                              sophisticated system that attempts to maintain the
                              most realistic yet conservative market behavior
                              possible, despite these limitations. At its core,
                              the platform always maintains an order book
                              simulation - even when you provide less granular
                              data such as quotes, trades, or bars (although the
                              simulation will only have a top level book).
                            </p>
                            <h4
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="processing-bar-data"
                            >
                              Processing Bar Data<a
                                href="#processing-bar-data"
                                class="hash-link"
                                aria-label="Direct link to Processing Bar Data"
                                title="Direct link to Processing Bar Data"
                                >​</a
                              >
                            </h4>
                            <p>
                              Even when you provide bar data, Posei maintains an
                              internal order book for each instrument - just
                              like a real venue would.
                            </p>
                            <ol>
                              <li>
                                <p><strong>Time Processing</strong>:</p>
                                <ul>
                                  <li>
                                    Posei has a specific way of handling the
                                    timing of bar data
                                    <em>for execution</em> that&#x27;s crucial
                                    for accurate simulation.
                                  </li>
                                  <li>
                                    Bar timestamps (<code>ts_event</code>) are
                                    expected to represent the close time of the
                                    bar. This approach is most logical because
                                    it represents the moment when the bar is
                                    fully formed and its aggregation is
                                    complete.
                                  </li>
                                  <li>
                                    The initialization time
                                    (<code>ts_init</code>) can be controlled
                                    using the
                                    <code>ts_init_delta</code> parameter in
                                    <code>BarDataWrangler</code>, which should
                                    typically be set to the bar&#x27;s step size
                                    (timeframe) in nanoseconds.
                                  </li>
                                  <li>
                                    The platform ensures all events happen in
                                    the correct sequence based on these
                                    timestamps, preventing any possibility of
                                    look-ahead bias in your backtests.
                                  </li>
                                </ul>
                              </li>
                              <li>
                                <p><strong>Price Processing</strong>:</p>
                                <ul>
                                  <li>
                                    The platform converts each bar&#x27;s OHLC
                                    prices into a sequence of market updates.
                                  </li>
                                  <li>
                                    These updates always follow the same order:
                                    Open → High → Low → Close.
                                  </li>
                                  <li>
                                    If you provide multiple timeframes (like
                                    both 1-minute and 5-minute bars), the
                                    platform uses the more granular data for
                                    highest accuracy.
                                  </li>
                                </ul>
                              </li>
                              <li>
                                <p><strong>Executions</strong>:</p>
                                <ul>
                                  <li>
                                    When you place orders, they interact with
                                    the simulated order book just like they
                                    would on a real venue.
                                  </li>
                                  <li>
                                    For MARKET orders, execution happens at the
                                    current simulated market price plus any
                                    configured latency.
                                  </li>
                                  <li>
                                    For LIMIT orders working in the market,
                                    they&#x27;ll execute if any of the
                                    bar&#x27;s prices reach or cross your limit
                                    price (see below).
                                  </li>
                                  <li>
                                    The matching engine continuously processes
                                    orders as OHLC prices move, rather than
                                    waiting for complete bars.
                                  </li>
                                </ul>
                              </li>
                            </ol>
                            <h4
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="ohlc-prices-simulation"
                            >
                              OHLC Prices Simulation<a
                                href="#ohlc-prices-simulation"
                                class="hash-link"
                                aria-label="Direct link to OHLC Prices Simulation"
                                title="Direct link to OHLC Prices Simulation"
                                >​</a
                              >
                            </h4>
                            <p>
                              During backtest execution, each bar is converted
                              into a sequence of four price points:
                            </p>
                            <ol>
                              <li>Opening price</li>
                              <li>
                                High price
                                <em
                                  >(Order between High/Low is configurable. See
                                  <code>bar_adaptive_high_low_ordering</code>
                                  below.)</em
                                >
                              </li>
                              <li>Low price</li>
                              <li>Closing price</li>
                            </ol>
                            <p>
                              The trading volume for that bar is
                              <strong>split evenly</strong> among these four
                              points (25% each). In marginal cases, if the
                              original bar&#x27;s volume divided by 4 is less
                              than the instrument&#x27;s minimum
                              <code>size_increment</code>, we still use the
                              minimum <code>size_increment</code> per price
                              point to ensure valid market activity (e.g., 1
                              contract for CME group exchanges).
                            </p>
                            <p>
                              How these price points are sequenced can be
                              controlled via the
                              <code>bar_adaptive_high_low_ordering</code>
                              parameter when configuring a venue.
                            </p>
                            <p>Posei supports two modes of bar processing:</p>
                            <ol>
                              <li>
                                <p>
                                  <strong>Fixed Ordering</strong>
                                  (<code>bar_adaptive_high_low_ordering=False</code>,
                                  default)
                                </p>
                                <ul>
                                  <li>
                                    Processes every bar in a fixed sequence:
                                    <code>Open → High → Low → Close</code>.
                                  </li>
                                  <li>Simple and deterministic approach.</li>
                                </ul>
                              </li>
                              <li>
                                <p>
                                  <strong>Adaptive Ordering</strong>
                                  (<code>bar_adaptive_high_low_ordering=True</code>)
                                </p>
                                <ul>
                                  <li>
                                    Uses bar structure to estimate likely price
                                    path:
                                    <ul>
                                      <li>
                                        If Open is closer to High: processes as
                                        <code>Open → High → Low → Close</code>.
                                      </li>
                                      <li>
                                        If Open is closer to Low: processes as
                                        <code>Open → Low → High → Close</code>.
                                      </li>
                                    </ul>
                                  </li>
                                  <li>
                                    <a
                                      href="https://gist.github.com/stefansimik/d387e1d9ff784a8973feca0cde51e363"
                                      target="_blank"
                                      rel="noopener noreferrer"
                                      >Research</a
                                    >
                                    shows this approach achieves ~75-85%
                                    accuracy in predicting correct High/Low
                                    sequence (compared to statistical ~50%
                                    accuracy with fixed ordering).
                                  </li>
                                  <li>
                                    This is particularly important when both
                                    take-profit and stop-loss levels occur
                                    within the same bar - as the sequence
                                    determines which order is filled first.
                                  </li>
                                </ul>
                              </li>
                            </ol>
                            <p>
                              Here&#x27;s how to configure adaptive bar ordering
                              for a venue, including account setup:
                            </p>
                            <div
                              class="language-python codeBlockContainer_Ckt0 theme-code-block"
                              style="
                                --prism-color: #9cdcfe;
                                --prism-background-color: #1e1e1e;
                              "
                            >
                              <div class="codeBlockContent_QJqH">
                                <pre
                                  tabindex="0"
                                  class="prism-code language-python codeBlock_bY9V thin-scrollbar"
                                  style="
                                    color: #9cdcfe;
                                    background-color: #1e1e1e;
                                  "
                                ><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">backtest</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">engine </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> BacktestEngine</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">enums </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> OmsType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> AccountType</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">model </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> Money</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Currency</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Initialize the backtest engine</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">engine </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> BacktestEngine</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Add a venue with adaptive bar ordering and required account settings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">engine</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">add_venue</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    venue</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">venue</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Your Venue identifier, e.g., Venue(&quot;BINANCE&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    oms_type</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">OmsType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">NETTING</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    account_type</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">AccountType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">CASH</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    starting_balances</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">Money</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">10_000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Currency</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">from_str</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;USDT&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    bar_adaptive_high_low_ordering</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Enable adaptive ordering of High/Low bar prices</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre>
                              </div>
                            </div>
                            <h3
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="slippage-and-spread-handling"
                            >
                              Slippage and Spread Handling<a
                                href="#slippage-and-spread-handling"
                                class="hash-link"
                                aria-label="Direct link to Slippage and Spread Handling"
                                title="Direct link to Slippage and Spread Handling"
                                >​</a
                              >
                            </h3>
                            <p>
                              When backtesting with different types of data,
                              Posei implements specific handling for slippage
                              and spread simulation:
                            </p>
                            <p>
                              For L2 (market-by-price) or L3 (market-by-order)
                              data, slippage is simulated with high accuracy by:
                            </p>
                            <ul>
                              <li>
                                Filling orders against actual order book levels.
                              </li>
                              <li>
                                Matching available size at each price level
                                sequentially.
                              </li>
                              <li>
                                Maintaining realistic order book depth impact
                                (per order fill).
                              </li>
                            </ul>
                            <p>
                              For L1 data types (e.g., L1 order book, trades,
                              quotes, bars), slippage is handled through:
                            </p>
                            <p>
                              <strong>Initial fill slippage</strong>
                              (<code>prob_slippage</code>):
                            </p>
                            <ul>
                              <li>
                                Controlled by the
                                <code>prob_slippage</code> parameter of the
                                <code>FillModel</code>.
                              </li>
                              <li>
                                Determines if the initial fill will occur one
                                tick away from current market price.
                              </li>
                              <li>
                                Example: With <code>prob_slippage=0.5</code>, a
                                market BUY has 50% chance of filling one tick
                                above the best ask price.
                              </li>
                            </ul>
                            <div
                              class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"
                            >
                              <div class="admonitionHeading_Gvgb">
                                <span class="admonitionIcon_Rf37"
                                  ><svg viewbox="0 0 14 16">
                                    <path
                                      fill-rule="evenodd"
                                      d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"
                                    ></path></svg></span
                                >note
                              </div>
                              <div class="admonitionContent_BuS1">
                                <p>
                                  When backtesting with bar data, be aware that
                                  the reduced granularity of price information
                                  affects the slippage mechanism. For the most
                                  realistic backtesting results, consider using
                                  higher granularity data sources such as L2 or
                                  L3 order book data when available.
                                </p>
                              </div>
                            </div>
                            <h3
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="fill-model"
                            >
                              Fill Model<a
                                href="#fill-model"
                                class="hash-link"
                                aria-label="Direct link to Fill Model"
                                title="Direct link to Fill Model"
                                >​</a
                              >
                            </h3>
                            <p>
                              The <code>FillModel</code> helps simulate order
                              queue position and execution in a simple
                              probabilistic way during backtesting. It addresses
                              a fundamental challenge:
                              <em
                                >even with perfect historical market data, we
                                can&#x27;t fully simulate how orders may have
                                interacted with other market participants in
                                real-time</em
                              >.
                            </p>
                            <p>
                              The <code>FillModel</code> simulates two key
                              aspects of trading that exist in real markets
                              regardless of data quality:
                            </p>
                            <ol>
                              <li>
                                <p>
                                  <strong
                                    >Queue Position for Limit Orders</strong
                                  >:
                                </p>
                                <ul>
                                  <li>
                                    When multiple traders place orders at the
                                    same price level, the order&#x27;s position
                                    in the queue affects if and when it gets
                                    filled.
                                  </li>
                                </ul>
                              </li>
                              <li>
                                <p>
                                  <strong>Market Impact and Competition</strong
                                  >:
                                </p>
                                <ul>
                                  <li>
                                    When taking liquidity with market orders,
                                    you compete with other traders for available
                                    liquidity, which can affect your fill price.
                                  </li>
                                </ul>
                              </li>
                            </ol>
                            <h4
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="configuration-and-parameters"
                            >
                              Configuration and Parameters<a
                                href="#configuration-and-parameters"
                                class="hash-link"
                                aria-label="Direct link to Configuration and Parameters"
                                title="Direct link to Configuration and Parameters"
                                >​</a
                              >
                            </h4>
                            <div
                              class="language-python codeBlockContainer_Ckt0 theme-code-block"
                              style="
                                --prism-color: #9cdcfe;
                                --prism-background-color: #1e1e1e;
                              "
                            >
                              <div class="codeBlockContent_QJqH">
                                <pre
                                  tabindex="0"
                                  class="prism-code language-python codeBlock_bY9V thin-scrollbar"
                                  style="
                                    color: #9cdcfe;
                                    background-color: #1e1e1e;
                                  "
                                ><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">backtest</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">models </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> FillModel</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">backtest</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">engine </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> BacktestEngine</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">backtest</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">engine </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> BacktestEngineConfig</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Create a custom fill model with your desired probabilities</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">fill_model </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> FillModel</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    prob_fill_on_limit</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token number" style="color:rgb(181, 206, 168)">0.2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Chance a limit order fills when price matches (applied to bars/trades/quotes + L1/L2/L3 order book)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    prob_fill_on_stop</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token number" style="color:rgb(181, 206, 168)">0.95</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># [DEPRECATED] Will be removed in a future version, use `prob_slippage` instead</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    prob_slippage</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token number" style="color:rgb(181, 206, 168)">0.5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">         </span><span class="token comment" style="color:rgb(106, 153, 85)"># Chance of 1-tick slippage (applied to bars/trades/quotes + L1 order book only)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    random_seed</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)"># Optional: Set for reproducible results</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Add the fill model to your engine configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">engine </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> BacktestEngine</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    config</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">BacktestEngineConfig</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        trader_id</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;TESTER-001&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        fill_model</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">fill_model</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Inject your custom fill model here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre>
                              </div>
                            </div>
                            <p>
                              <strong>prob_fill_on_limit</strong> (default:
                              <code>1.0</code>)
                            </p>
                            <ul>
                              <li>
                                Purpose:
                                <ul>
                                  <li>
                                    Simulates the probability of a limit order
                                    getting filled when its price level is
                                    reached in the market.
                                  </li>
                                </ul>
                              </li>
                              <li>
                                Details:
                                <ul>
                                  <li>
                                    Simulates your position in the order queue
                                    at a given price level.
                                  </li>
                                  <li>
                                    Applies to all data types (e.g., L1/L2/L3
                                    order book, quotes, trades, bars).
                                  </li>
                                  <li>
                                    New random probability check occurs each
                                    time market price touches your order price
                                    (but does not move through it).
                                  </li>
                                  <li>
                                    On successful probability check, fills
                                    entire remaining order quantity.
                                  </li>
                                </ul>
                              </li>
                            </ul>
                            <p><strong>Examples</strong>:</p>
                            <ul>
                              <li>
                                With <code>prob_fill_on_limit=0.0</code>:
                                <ul>
                                  <li>
                                    Limit BUY orders never fill when best ask
                                    reaches the limit price.
                                  </li>
                                  <li>
                                    Limit SELL orders never fill when best bid
                                    reaches the limit price.
                                  </li>
                                  <li>
                                    This simulates being at the very back of the
                                    queue and never reaching the front.
                                  </li>
                                </ul>
                              </li>
                              <li>
                                With <code>prob_fill_on_limit=0.5</code>:
                                <ul>
                                  <li>
                                    Limit BUY orders have 50% chance of filling
                                    when best ask reaches the limit price.
                                  </li>
                                  <li>
                                    Limit SELL orders have 50% chance of filling
                                    when best bid reaches the limit price.
                                  </li>
                                  <li>
                                    This simulates being in the middle of the
                                    queue.
                                  </li>
                                </ul>
                              </li>
                              <li>
                                With
                                <code>prob_fill_on_limit=1.0</code> (default):
                                <ul>
                                  <li>
                                    Limit BUY orders always fill when best ask
                                    reaches the limit price.
                                  </li>
                                  <li>
                                    Limit SELL orders always fill when best bid
                                    reaches the limit price.
                                  </li>
                                  <li>
                                    This simulates being at the front of the
                                    queue with guaranteed fills.
                                  </li>
                                </ul>
                              </li>
                            </ul>
                            <p>
                              <strong>prob_slippage</strong> (default:
                              <code>0.0</code>)
                            </p>
                            <ul>
                              <li>
                                Purpose:
                                <ul>
                                  <li>
                                    Simulates the probability of experiencing
                                    price slippage when executing market orders.
                                  </li>
                                </ul>
                              </li>
                              <li>
                                Details:
                                <ul>
                                  <li>
                                    Only applies to L1 data types (e.g., quotes,
                                    trades, bars).
                                  </li>
                                  <li>
                                    When triggered, moves fill price one tick
                                    against your order direction.
                                  </li>
                                  <li>
                                    Affects all market-type orders
                                    (<code>MARKET</code>,
                                    <code>MARKET_TO_LIMIT</code>,
                                    <code>MARKET_IF_TOUCHED</code>,
                                    <code>STOP_MARKET</code>).
                                  </li>
                                  <li>
                                    Not utilized with L2/L3 data where order
                                    book depth can determine slippage.
                                  </li>
                                </ul>
                              </li>
                            </ul>
                            <p><strong>Examples</strong>:</p>
                            <ul>
                              <li>
                                With <code>prob_slippage=0.0</code> (default):
                                <ul>
                                  <li>
                                    No artificial slippage is applied,
                                    representing an idealized scenario where you
                                    always get filled at the current market
                                    price.
                                  </li>
                                </ul>
                              </li>
                              <li>
                                With <code>prob_slippage=0.5</code>:
                                <ul>
                                  <li>
                                    Market BUY orders have 50% chance of filling
                                    one tick above the best ask price, and 50%
                                    chance at the best ask price.
                                  </li>
                                  <li>
                                    Market SELL orders have 50% chance of
                                    filling one tick below the best bid price,
                                    and 50% chance at the best bid price.
                                  </li>
                                </ul>
                              </li>
                              <li>
                                With <code>prob_slippage=1.0</code>:
                                <ul>
                                  <li>
                                    Market BUY orders always fill one tick above
                                    the best ask price.
                                  </li>
                                  <li>
                                    Market SELL orders always fill one tick
                                    below the best bid price.
                                  </li>
                                  <li>
                                    This simulates consistent adverse price
                                    movement against your orders.
                                  </li>
                                </ul>
                              </li>
                            </ul>
                            <p>
                              <strong>prob_fill_on_stop</strong> (default:
                              <code>1.0</code>)
                            </p>
                            <ul>
                              <li>
                                Stop order is just shorter name for stop-market
                                order, that convert to market orders when
                                market-price touches the stop-price.
                              </li>
                              <li>
                                That means, stop order order-fill mechanics is
                                simply market-order mechanics, that is
                                controlled by the
                                <code>prob_slippage</code> parameter.
                              </li>
                            </ul>
                            <div
                              class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"
                            >
                              <div class="admonitionHeading_Gvgb">
                                <span class="admonitionIcon_Rf37"
                                  ><svg viewbox="0 0 16 16">
                                    <path
                                      fill-rule="evenodd"
                                      d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"
                                    ></path></svg></span
                                >warning
                              </div>
                              <div class="admonitionContent_BuS1">
                                <p>
                                  The <code>prob_fill_on_stop</code> parameter
                                  is deprecated and will be removed in a future
                                  version (use
                                  <code>prob_slippage</code> instead).
                                </p>
                              </div>
                            </div>
                            <h4
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="how-simulation-varies-by-data-type"
                            >
                              How Simulation Varies by Data Type<a
                                href="#how-simulation-varies-by-data-type"
                                class="hash-link"
                                aria-label="Direct link to How Simulation Varies by Data Type"
                                title="Direct link to How Simulation Varies by Data Type"
                                >​</a
                              >
                            </h4>
                            <p>
                              The behavior of the <code>FillModel</code> adapts
                              based on the order book type being used:
                            </p>
                            <p><strong>L2/L3 Orderbook data</strong></p>
                            <p>
                              With full order book depth, the
                              <code>FillModel</code> focuses purely on
                              simulating queue position for limit orders through
                              <code>prob_fill_on_limit</code>. The order book
                              itself handles slippage naturally based on
                              available liquidity at each price level.
                            </p>
                            <ul>
                              <li>
                                <code>prob_fill_on_limit</code> is active -
                                simulates queue position.
                              </li>
                              <li>
                                <code>prob_slippage</code> is not used - real
                                order book depth determines price impact.
                              </li>
                            </ul>
                            <p><strong>L1 Orderbook data</strong></p>
                            <p>
                              With only best bid/ask prices available, the
                              <code>FillModel</code> provides additional
                              simulation:
                            </p>
                            <ul>
                              <li>
                                <code>prob_fill_on_limit</code> is active -
                                simulates queue position.
                              </li>
                              <li>
                                <code>prob_slippage</code> is active - simulates
                                basic price impact since we lack real depth
                                information.
                              </li>
                            </ul>
                            <p><strong>Bar/Quote/Trade data</strong></p>
                            <p>
                              When using less granular data, the same behaviors
                              apply as L1:
                            </p>
                            <ul>
                              <li>
                                <code>prob_fill_on_limit</code> is active -
                                simulates queue position.
                              </li>
                              <li>
                                <code>prob_slippage</code> is active - simulates
                                basic price impact.
                              </li>
                            </ul>
                            <h4
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="important-considerations"
                            >
                              Important Considerations<a
                                href="#important-considerations"
                                class="hash-link"
                                aria-label="Direct link to Important Considerations"
                                title="Direct link to Important Considerations"
                                >​</a
                              >
                            </h4>
                            <p>
                              The <code>FillModel</code> has certain limitations
                              to keep in mind:
                            </p>
                            <ul>
                              <li>
                                <strong>Partial fills are supported</strong>
                                with L2/L3 order book data - when there is no
                                longer any size available in the order book, no
                                more fills will be generated and the order will
                                remain in a partially filled state. This
                                accurately simulates real market conditions
                                where not enough liquidity is available at the
                                desired price levels.
                              </li>
                              <li>
                                With L1 data, slippage is limited to a fixed
                                1-tick, at which entire order&#x27;s quantity is
                                filled.
                              </li>
                            </ul>
                            <div
                              class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"
                            >
                              <div class="admonitionHeading_Gvgb">
                                <span class="admonitionIcon_Rf37"
                                  ><svg viewbox="0 0 14 16">
                                    <path
                                      fill-rule="evenodd"
                                      d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"
                                    ></path></svg></span
                                >note
                              </div>
                              <div class="admonitionContent_BuS1">
                                <p>
                                  As the <code>FillModel</code> continues to
                                  evolve, future versions may introduce more
                                  sophisticated simulation of order execution
                                  dynamics, including:
                                </p>
                                <ul>
                                  <li>Partial fill simulation</li>
                                  <li>Variable slippage based on order size</li>
                                  <li>More complex queue position modeling</li>
                                </ul>
                              </div>
                            </div>
                            <h2
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="account-types"
                            >
                              Account Types<a
                                href="#account-types"
                                class="hash-link"
                                aria-label="Direct link to Account Types"
                                title="Direct link to Account Types"
                                >​</a
                              >
                            </h2>
                            <p>
                              When you attach a venue to the engine—either for
                              live trading or a back‑test—you must pick one of
                              three accounting modes by passing the
                              <code>account_type</code> parameter:
                            </p>

                            <table>
                              <thead>
                                <tr>
                                  <th>Account type</th>
                                  <th>Typical use-case</th>
                                  <th>What the engine locks</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr>
                                  <td>Cash</td>
                                  <td>Spot trading (e.g. BTC/USDT, stocks)</td>
                                  <td>
                                    Notional value for every position a pending
                                    order would open.
                                  </td>
                                </tr>
                                <tr>
                                  <td>Margin</td>
                                  <td>
                                    Derivatives or any product that allows
                                    leverage
                                  </td>
                                  <td>
                                    Initial margin for each order plus
                                    maintenance margin for open positions.
                                  </td>
                                </tr>
                                <tr>
                                  <td>Betting</td>
                                  <td>Sports betting, book‑making</td>
                                  <td>
                                    Stake required by the venue; no leverage.
                                  </td>
                                </tr>
                              </tbody>
                            </table>
                            <p>
                              Example of adding a <code>CASH</code> account for
                              a backtest venue:
                            </p>
                            <div
                              class="language-python codeBlockContainer_Ckt0 theme-code-block"
                              style="
                                --prism-color: #9cdcfe;
                                --prism-background-color: #1e1e1e;
                              "
                            >
                              <div class="codeBlockContent_QJqH">
                                <pre
                                  tabindex="0"
                                  class="prism-code language-python codeBlock_bY9V thin-scrollbar"
                                  style="
                                    color: #9cdcfe;
                                    background-color: #1e1e1e;
                                  "
                                ><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">adapters</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">binance </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> BINANCE_VENUE</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">backtest</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">engine </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> BacktestEngine</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">currencies </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> USDT</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">enums </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> OmsType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> AccountType</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> posei_trader</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">model </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> Money</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Currency</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Initialize the backtest engine</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">engine </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> BacktestEngine</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Add a CASH account for the venue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">engine</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">add_venue</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    venue</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">BINANCE_VENUE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Create or reference a Venue identifier</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    oms_type</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">OmsType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">NETTING</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    account_type</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">AccountType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">CASH</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    starting_balances</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">Money</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">10_000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> USDT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre>
                              </div>
                            </div>
                            <h3
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="cash-accounts"
                            >
                              Cash Accounts<a
                                href="#cash-accounts"
                                class="hash-link"
                                aria-label="Direct link to Cash Accounts"
                                title="Direct link to Cash Accounts"
                                >​</a
                              >
                            </h3>
                            <p>
                              Cash accounts settle trades in full; there is no
                              leverage and therefore no concept of margin.
                            </p>
                            <h3
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="margin-accounts"
                            >
                              Margin Accounts<a
                                href="#margin-accounts"
                                class="hash-link"
                                aria-label="Direct link to Margin Accounts"
                                title="Direct link to Margin Accounts"
                                >​</a
                              >
                            </h3>
                            <p>
                              A <em>margin account</em> facilitates trading of
                              instruments requiring margin, such as futures or
                              leveraged products. It tracks account balances,
                              calculates required margins, and manages leverage
                              to ensure sufficient collateral for positions and
                              orders.
                            </p>
                            <p><strong>Key Concepts</strong>:</p>
                            <ul>
                              <li>
                                <strong>Leverage</strong>: Amplifies trading
                                exposure relative to account equity. Higher
                                leverage increases potential returns and risks.
                              </li>
                              <li>
                                <strong>Initial Margin</strong>: Collateral
                                required to submit an order to open a position.
                              </li>
                              <li>
                                <strong>Maintenance Margin</strong>: Minimum
                                collateral required to maintain an open
                                position.
                              </li>
                              <li>
                                <strong>Locked Balance</strong>: Funds reserved
                                as collateral, unavailable for new orders or
                                withdrawals.
                              </li>
                            </ul>
                            <div
                              class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"
                            >
                              <div class="admonitionHeading_Gvgb">
                                <span class="admonitionIcon_Rf37"
                                  ><svg viewbox="0 0 14 16">
                                    <path
                                      fill-rule="evenodd"
                                      d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"
                                    ></path></svg></span
                                >note
                              </div>
                              <div class="admonitionContent_BuS1">
                                <p>
                                  Reduce-only orders
                                  <strong>do not</strong> contribute to
                                  <code>balance_locked</code> in cash accounts,
                                  nor do they add to initial margin in margin
                                  accounts—as they can only reduce existing
                                  exposure.
                                </p>
                              </div>
                            </div>
                            <h3
                              class="anchor anchorWithHideOnScrollNavbar_WYt5"
                              id="betting-accounts"
                            >
                              Betting Accounts<a
                                href="#betting-accounts"
                                class="hash-link"
                                aria-label="Direct link to Betting Accounts"
                                title="Direct link to Betting Accounts"
                                >​</a
                              >
                            </h3>
                            <p>
                              Betting accounts are specialised for venues where
                              you stake an amount to win or lose a fixed payout
                              (some prediction markets, sports books, etc.). The
                              engine locks only the stake required by the venue;
                              leverage and margin are not applicable.
                            </p>
                          </div>
                        </article>
                        <nav
                          class="docusaurus-mt-lg pagination-nav"
                          aria-label="Docs pages"
                        >
                          <a
                            class="pagination-nav__link pagination-nav__link--prev"
                            href="../logging/index.htm"
                            ><div class="pagination-nav__sublabel">
                              Previous
                            </div>
                            <div class="pagination-nav__label">Logging</div></a
                          ><a
                            class="pagination-nav__link pagination-nav__link--next"
                            href="../live/index.htm"
                            ><div class="pagination-nav__sublabel">Next</div>
                            <div class="pagination-nav__label">
                              Live Trading
                            </div></a
                          >
                        </nav>
                      </div>
                    </div>
                    <div class="col col--3">
                      <div
                        class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"
                      >
                        <ul
                          class="table-of-contents table-of-contents__left-border"
                        >
                          <li>
                            <a
                              href="#choosing-an-api-level"
                              class="table-of-contents__link toc-highlight"
                              >Choosing an API level</a
                            >
                          </li>
                          <li>
                            <a
                              href="#low-level-api"
                              class="table-of-contents__link toc-highlight"
                              >Low-level API</a
                            >
                          </li>
                          <li>
                            <a
                              href="#high-level-api"
                              class="table-of-contents__link toc-highlight"
                              >High-level API</a
                            >
                          </li>
                          <li>
                            <a
                              href="#data"
                              class="table-of-contents__link toc-highlight"
                              >Data</a
                            >
                            <ul>
                              <li>
                                <a
                                  href="#choosing-data-cost-vs-accuracy"
                                  class="table-of-contents__link toc-highlight"
                                  >Choosing data: Cost vs. Accuracy</a
                                >
                              </li>
                            </ul>
                          </li>
                          <li>
                            <a
                              href="#venues"
                              class="table-of-contents__link toc-highlight"
                              >Venues</a
                            >
                          </li>
                          <li>
                            <a
                              href="#execution"
                              class="table-of-contents__link toc-highlight"
                              >Execution</a
                            >
                            <ul>
                              <li>
                                <a
                                  href="#bar-based-execution"
                                  class="table-of-contents__link toc-highlight"
                                  >Bar Based Execution</a
                                >
                              </li>
                              <li>
                                <a
                                  href="#slippage-and-spread-handling"
                                  class="table-of-contents__link toc-highlight"
                                  >Slippage and Spread Handling</a
                                >
                              </li>
                              <li>
                                <a
                                  href="#fill-model"
                                  class="table-of-contents__link toc-highlight"
                                  >Fill Model</a
                                >
                              </li>
                            </ul>
                          </li>
                          <li>
                            <a
                              href="#account-types"
                              class="table-of-contents__link toc-highlight"
                              >Account Types</a
                            >
                            <ul>
                              <li>
                                <a
                                  href="#cash-accounts"
                                  class="table-of-contents__link toc-highlight"
                                  >Cash Accounts</a
                                >
                              </li>
                              <li>
                                <a
                                  href="#margin-accounts"
                                  class="table-of-contents__link toc-highlight"
                                  >Margin Accounts</a
                                >
                              </li>
                              <li>
                                <a
                                  href="#betting-accounts"
                                  class="table-of-contents__link toc-highlight"
                                  >Betting Accounts</a
                                >
                              </li>
                            </ul>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                  <div class="footer-wrapper MuiBox-root css-0">
                    <div class="social-footer-box MuiBox-root css-0">
                      <style data-emotion="css 17rjyz3">
                        .css-17rjyz3 {
                          -webkit-text-decoration: underline;
                          text-decoration: underline;
                          text-decoration-color: rgba(25, 118, 210, 0.4);
                          padding: 12px;
                          margin-right: 10px;
                        }
                        .css-17rjyz3:hover {
                          text-decoration-color: inherit;
                        }</style
                      ><style data-emotion="css jl1bw5">
                        .css-jl1bw5 {
                          margin: 0;
                          font: inherit;
                          color: #1976d2;
                          -webkit-text-decoration: underline;
                          text-decoration: underline;
                          text-decoration-color: rgba(25, 118, 210, 0.4);
                          padding: 12px;
                          margin-right: 10px;
                        }
                        .css-jl1bw5:hover {
                          text-decoration-color: inherit;
                        }</style
                      ><a
                        class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways github-footer css-jl1bw5"
                        href="https://github.com/poseisysstems"
                        target="_blank"
                      ></a
                      ><a
                        class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways x-footer css-jl1bw5"
                        href="https://twitter.com/PoseiTrader"
                        target="_blank"
                      ></a>
                    </div>
                    <div class="footer-copyright">
                      © 2025 Posei Systems Pty Ltd. All rights reserved.
                    </div>
                  </div>
                </div>
              </div>
            </main>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
